"use strict";(self.webpackChunkazure_maps_storybook=self.webpackChunkazure_maps_storybook||[]).push([[164],{"./src/stories/MapAnnotations/Popup/Interactive/InteractivePopup.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Example:()=>Example,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__={title:"Map Annotations/Interactive Popup",component:__webpack_require__("./src/stories/MapAnnotations/Popup/Interactive/InteractivePopupExample.tsx").A,args:{isVisible:!0,options:{position:[0,0]}},parameters:{storySource:{source:"\nimport { useContext, useEffect, useState, ReactNode } from 'react';\nimport { createRoot } from 'react-dom/client';\nimport atlas from 'azure-maps-control';\nimport { IAzureMapsContextProps, AzureMapsContext, IAzureMapPopupEvent } from 'react-azure-maps';\n\ninterface InteractivePopupProps {\n  children: ReactNode;\n  isVisible?: boolean;\n  options?: atlas.PopupOptions;\n  events?: IAzureMapPopupEvent[];\n};\n\nconst InteractivePopup = ({ children, isVisible = true, options, events }: InteractivePopupProps) => {\n  const { mapRef } = useContext<IAzureMapsContextProps>(AzureMapsContext);\n  const containerRef = document.createElement('div');\n  const root = createRoot(containerRef);\n  const [popupRef] = useState<atlas.Popup>(new atlas.Popup({ ...options, content: containerRef }));\n\n  // Add events to the popup when it is mounted\n  useEffect(() => {\n    if (mapRef) {\n      events &&\n        events.forEach(({ eventName, callback }) => {\n          mapRef.events.add(eventName, popupRef, callback);\n        });\n      return () => {\n        mapRef.popups.remove(popupRef);\n      };\n    }\n  }, []);\n\n  // Render the popup content and set the options\n  useEffect(() => {\n    root.render(children);\n    popupRef.setOptions({\n      ...options,\n      content: containerRef,\n    });\n    if (mapRef && isVisible && !popupRef.isOpen()) {\n      popupRef.open(mapRef);\n    }\n  }, [options, children]);\n\n  // Toggle the popup visibility\n  useEffect(() => {\n    if (mapRef) {\n      if (isVisible && !popupRef.isOpen()) {\n        popupRef.open(mapRef);\n      } else if (mapRef.popups.getPopups().length && !isVisible && popupRef.isOpen()) {\n        popupRef.close();\n      }\n    }\n  }, [isVisible]);\n\n  return null;\n};\n"}}},Example={},__namedExportsOrder=["Example"];Example.parameters={...Example.parameters,docs:{...Example.parameters?.docs,source:{originalSource:"{}",...Example.parameters?.docs?.source}}}},"./src/key.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{t:()=>mapOptions});const mapOptions={authOptions:{authType:__webpack_require__("./node_modules/react-azure-maps/dist/react-azure-maps.es5.js").h_.anonymous,clientId:"2a60774c-f588-423b-b004-56d213773ee6",getToken:(resolve,reject)=>{fetch("https://anonymous-auth.azurewebsites.net/api/GetAccessToken-Prod").then((result=>result.text())).then((result=>resolve(result))).catch((error=>reject(new Error("Failed to fetch anon auth token: ".concat(error.message)))))}},center:[0,0],view:"Auto"}},"./src/stories/MapAnnotations/Popup/Interactive/InteractivePopupExample.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>Interactive_InteractivePopupExample});var react_azure_maps_es5=__webpack_require__("./node_modules/react-azure-maps/dist/react-azure-maps.es5.js"),key=__webpack_require__("./src/key.ts"),react=__webpack_require__("./node_modules/react/index.js"),client=__webpack_require__("./node_modules/react-dom/client.js"),atlas_esm_min=__webpack_require__("./node_modules/azure-maps-control/dist/atlas-esm.min.js");const Interactive_InteractivePopup=_ref=>{let{children,isVisible=!0,options,events}=_ref;const{mapRef}=(0,react.useContext)(react_azure_maps_es5.ON),containerRef=document.createElement("div"),root=(0,client.createRoot)(containerRef),[popupRef]=(0,react.useState)(new atlas_esm_min.Ay.Popup({...options,content:containerRef}));return(0,react.useEffect)((()=>{if(mapRef)return events&&events.forEach((_ref2=>{let{eventName,callback}=_ref2;mapRef.events.add(eventName,popupRef,callback)})),()=>{mapRef.popups.remove(popupRef)}}),[]),(0,react.useEffect)((()=>{root.render(children),popupRef.setOptions({...options,content:containerRef}),mapRef&&isVisible&&!popupRef.isOpen()&&popupRef.open(mapRef)}),[options,children]),(0,react.useEffect)((()=>{mapRef&&(isVisible&&!popupRef.isOpen()?popupRef.open(mapRef):mapRef.popups.getPopups().length&&!isVisible&&popupRef.isOpen()&&popupRef.close())}),[isVisible]),null};var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js");const PopupContent=_ref=>{let{bgColor}=_ref;const[count,setCount]=(0,react.useState)(0);return(0,jsx_runtime.jsxs)("div",{style:{padding:"10px",backgroundColor:bgColor,textAlign:"center"},children:[(0,jsx_runtime.jsx)("h3",{children:"This is a counter:"}),(0,jsx_runtime.jsxs)("p",{children:["You have clicked ",count," times."]}),(0,jsx_runtime.jsx)("button",{style:{border:"1px",padding:"4px",cursor:"pointer",backgroundColor:"gainsboro"},onClick:()=>{setCount(count+1)},children:"Click me"}),(0,jsx_runtime.jsx)("button",{style:{border:"1px",padding:"4px",cursor:"pointer",color:"blue",backgroundColor:"transparent"},onClick:()=>{setCount(0)},children:"Reset"})]})},Interactive_PopupContent=PopupContent;PopupContent.__docgenInfo={description:"",methods:[],displayName:"PopupContent",props:{bgColor:{required:!0,tsType:{name:"string"},description:""}}};const InteractivePopupExample=_ref=>{let{isVisible,options}=_ref;const[bgColor,setBgColor]=(0,react.useState)("white");return(0,jsx_runtime.jsx)(react_azure_maps_es5.oY,{children:(0,jsx_runtime.jsxs)("div",{children:[(0,jsx_runtime.jsx)("button",{onClick:()=>{const color="#".concat(Math.floor(16777215*Math.random()).toString(16));setBgColor(color)},style:{marginBottom:"10px"},children:"Change popup color"}),(0,jsx_runtime.jsx)("div",{className:"defaultMap sb-unstyled",children:(0,jsx_runtime.jsx)(react_azure_maps_es5._9,{options:key.t,children:(0,jsx_runtime.jsx)(Interactive_InteractivePopup,{isVisible,options,children:(0,jsx_runtime.jsx)(Interactive_PopupContent,{bgColor})})})})]})})},Interactive_InteractivePopupExample=InteractivePopupExample;InteractivePopupExample.__docgenInfo={description:"",methods:[],displayName:"InteractivePopupExample"}}}]);